"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[617],{956:function(a,o,i){i.d(o,{A:function(){return z}});var t=i(6768),r=i(4232);const s={class:"main"},e={key:0,class:"colunas"},l={class:"colunaEsquerda"},n={class:"colunaSaldo"},c={class:"saldo"},d={class:"precoProduto"},u={class:"saldoFinal"},p={class:"colunaDireita"},m={class:"carrinho"},C={class:"listaLivros"},v=["src","alt"],h={class:"detalhes"},k={class:"tituloLivro"},L={class:"quantidade"},f={key:1,class:"comprado"};function b(a,o,i,b,g,y){const E=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",s,[g.compradoComSucesso?((0,t.uX)(),(0,t.CE)("div",f,[o[8]||(o[8]=(0,t.Lk)("h1",null,"Compra realizada com sucesso!",-1)),(0,t.Lk)("p",null,[o[7]||(o[7]=(0,t.eW)("Veja seus livros adquiridos: ")),(0,t.bF)(E,{class:"link",to:"/minhasCompras"},{default:(0,t.k6)((()=>o[6]||(o[6]=[(0,t.eW)("aqui")]))),_:1})])])):((0,t.uX)(),(0,t.CE)("div",e,[(0,t.Lk)("div",l,[o[5]||(o[5]=(0,t.Lk)("label",{class:"tituloColuna"},"Seu saldo",-1)),(0,t.Lk)("div",n,[(0,t.Lk)("span",c,"R$ "+(0,r.v_)(g.saldoCliente),1),(0,t.Lk)("button",{class:"botaoAdd",onClick:o[0]||(o[0]=(...a)=>y.atualizarSaldo50&&y.atualizarSaldo50(...a))},"+ R$ 50")]),(0,t.Lk)("div",d,[o[3]||(o[3]=(0,t.Lk)("label",null,"Total da compra",-1)),(0,t.Lk)("span",null,"R$ "+(0,r.v_)(i.total),1)]),(0,t.Lk)("div",u,[o[4]||(o[4]=(0,t.Lk)("label",null,"Saldo final",-1)),(0,t.Lk)("span",null,"R$ "+(0,r.v_)(y.getSaldoFinal()),1)]),(0,t.Lk)("button",{class:"botaoConfirmar",onClick:o[1]||(o[1]=(...a)=>y.finalizarCompra&&y.finalizarCompra(...a))}," Finalizar compra ")]),(0,t.Lk)("div",p,[(0,t.Lk)("div",m,[(0,t.Lk)("ul",C,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(i.itens,((a,o)=>((0,t.uX)(),(0,t.CE)("li",{key:o,class:"itemLivro"},[(0,t.Lk)("img",{src:"http://localhost:8000"+a.livro.img,alt:"Capa do livro"+a.livro.titulo},null,8,v),(0,t.Lk)("div",h,[(0,t.Lk)("span",k,(0,r.v_)(a.livro.titulo),1),(0,t.Lk)("span",L,"x"+(0,r.v_)(a.quantidade??1),1)])])))),128))])])])])),(0,t.Lk)("div",{class:"fecharCompra",onClick:o[2]||(o[2]=(...a)=>y.fecharCompra&&y.fecharCompra(...a))},"X")])}var g=i(6373),y={name:"TelaPagamento",props:{itens:{type:Array,required:!0},total:{type:String,required:!0}},data(){return{saldoCliente:0,compradoComSucesso:!1}},async created(){try{const a=await(0,g.UY)();this.saldoCliente=parseFloat(a.data)}catch(a){console.error("Erro ao buscar saldo:",a)}},methods:{async finalizarCompra(){await Promise.all(this.itens.map((({livro:a,quantidade:o})=>this.$store.dispatch("comprarLivro",{idLivro:a.id,quantidade:o})))),await this.$store.dispatch("carregarItensCarrinho");const{data:a}=await(0,g.UY)();this.saldoCliente=Number(a.saldo??a),this.compradoComSucesso=!0},getSaldoFinal(){const a=(this.saldoCliente-parseFloat(this.total)).toFixed(2);return a},async atualizarSaldo50(){await(0,g.M0)();const a=await(0,g.UY)();this.saldoCliente=parseFloat(a.data)},fecharCompra(){this.$emit("confirmarCompra")}}},E=i(1241);const I=(0,E.A)(y,[["render",b],["__scopeId","data-v-2283059a"]]);var z=I},899:function(a,o,i){i.r(o),i.d(o,{default:function(){return O}});var t=i(6768);const r={class:"container"};function s(a,o,i,s,e,l){const n=(0,t.g2)("CarrinhoComponent");return(0,t.uX)(),(0,t.CE)("div",r,[(0,t.bF)(n)])}var e=i(4232),l=i(5130),n=i.p+"img/lixeira.865f4a83.svg";const c={class:"containerCarrinho"},d={class:"ladoDireitoEsquerdo"},u={class:"ladoEsquerdo"},p={key:0,class:"listaItensCarrinho"},m={class:"informacoesItem"},C=["src","alt"],v={class:"detalhesItem"},h={class:"nomeItem"},k={class:"precoItem"},L={class:"acoesItem"},f={class:"quantidadeControle"},b=["onClick"],g={key:0},y={key:1},E=["value"],I=["onClick"],z=["onClick"],F={key:1,class:"carrinhoVazio"},X={key:0,class:"ladoDireito"},q={class:"resumoCarrinho"},P={class:"textoResumo"},A={key:0},$={class:"cupomDesconto"},_={key:0,class:"finalizarCompra"};function S(a,o,i,r,s,S){const R=(0,t.g2)("TelaPagamento");return(0,t.uX)(),(0,t.CE)("div",c,[o[7]||(o[7]=(0,t.Lk)("div",{class:"tituloPrincipal"},"Carrinho de Compras",-1)),(0,t.Lk)("div",d,[(0,t.Lk)("div",u,[S.itensCarrinho.length?((0,t.uX)(),(0,t.CE)("div",p,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(S.itensCarrinho,((a,i)=>((0,t.uX)(),(0,t.CE)("div",{class:"itemCarrinho",key:i},[(0,t.Lk)("div",m,[(0,t.Lk)("img",{class:"imagemItem",src:"http://localhost:8000"+a.livro.img,alt:"Capa do livro "+a.livro.titulo},null,8,C),(0,t.Lk)("div",v,[(0,t.Lk)("div",h,(0,e.v_)(a.livro.titulo),1),(0,t.Lk)("p",k,"R$ "+(0,e.v_)(a.livro.preco),1)])]),(0,t.Lk)("div",L,[(0,t.Lk)("div",f,[(0,t.Lk)("button",{class:"botaoDiminuir",onClick:o=>S.diminuirQuantidade(a)},[a.quantidade>1?((0,t.uX)(),(0,t.CE)("div",g,"-")):((0,t.uX)(),(0,t.CE)("div",y,o[4]||(o[4]=[(0,t.Lk)("img",{src:n,alt:"ícone lixeira",style:{width:"20px","margin-top":"4px"}},null,-1)])))],8,b),(0,t.Lk)("input",{class:"quantidadeItem",type:"text",value:a.quantidade,readonly:""},null,8,E),(0,t.Lk)("button",{class:"botaoAumentar",onClick:o=>S.aumentarQuantidade(a)},"+",8,I)]),(0,t.Lk)("button",{class:"botaoRemover",onClick:o=>S.removerItem(i,a.livro.id)},"Remover",8,z)])])))),128))])):((0,t.uX)(),(0,t.CE)("div",F,o[5]||(o[5]=[(0,t.Lk)("p",null,"Não há itens no carrinho.",-1)])))]),S.itensCarrinho.length?((0,t.uX)(),(0,t.CE)("div",X,[(0,t.Lk)("div",q,[(0,t.Lk)("p",P,[o[6]||(o[6]=(0,t.eW)(" Total: ")),(0,t.Lk)("strong",null,[(0,t.eW)(" R$ "+(0,e.v_)(S.totalCarrinho)+" ",1),s.descontoAplicado?((0,t.uX)(),(0,t.CE)("span",A,"(cupom aplicado)")):(0,t.Q3)("",!0)])]),(0,t.Lk)("div",$,[(0,t.bo)((0,t.Lk)("input",{class:"campoCupom",type:"text",placeholder:"Insira seu cupom","onUpdate:modelValue":o[0]||(o[0]=a=>s.cupomDesconto=a),onKeyup:o[1]||(o[1]=(0,l.jR)(((...a)=>S.aplicarCupom&&S.aplicarCupom(...a)),["enter"]))},null,544),[[l.Jo,s.cupomDesconto]]),(0,t.Lk)("button",{class:"botaoAplicarCupom",onClick:o[2]||(o[2]=(...a)=>S.aplicarCupom&&S.aplicarCupom(...a))},"Aplicar")]),(0,t.Lk)("button",{class:"botaoFinalizar",onClick:o[3]||(o[3]=(...a)=>S.irParaCompra&&S.irParaCompra(...a))},"Finalizar Compra")])])):(0,t.Q3)("",!0)]),s.finalizarCompra?((0,t.uX)(),(0,t.CE)("div",_,[(0,t.bF)(R,{itens:S.itensCarrinho,total:Number(S.totalCarrinho),onConfirmarCompra:S.fecharCompra},null,8,["itens","total","onConfirmarCompra"])])):(0,t.Q3)("",!0)])}var R=i(956),U={components:{TelaPagamento:R.A},created(){this.$store.dispatch("carregarItensCarrinho")},data(){return{cupomDesconto:"",finalizarCompra:!1,descontoAplicado:0}},computed:{totalCarrinho(){const a=this.itensCarrinho.reduce(((a,o)=>a+parseFloat(o.livro.preco)*o.quantidade),0),o=a*(1-this.descontoAplicado);return o.toFixed(2)},itensCarrinho(){return this.$store.getters.getItensCarrinho}},methods:{aumentarQuantidade(a){this.$store.dispatch("atualizarQuantidade",{idLivro:a.livro.id,adicionar:!0})},diminuirQuantidade(a){this.$store.dispatch("atualizarQuantidade",{idLivro:a.livro.id,adicionar:!1})},removerItem(a,o){this.$store.dispatch("removerLivroDoCarrinho",o),this.itensCarrinho.splice(a,1)},aplicarCupom(){const a={CUPOM30:.3,CUPOM50:.5,CUPOM10:.1},o=this.cupomDesconto.trim().toUpperCase();o in a?this.descontoAplicado=a[o]:(this.descontoAplicado=0,alert("Cupom inválido. Tente CUPOM30, CUPOM50 ou CUPOM10."))},irParaCompra(){this.finalizarCompra=!0},fecharCompra(){this.finalizarCompra=!1}}},x=i(1241);const D=(0,x.A)(U,[["render",S],["__scopeId","data-v-afcbc9b4"]]);var w=D,Q={components:{CarrinhoComponent:w},created(){this.$store.dispatch("visitaRotaProtegida")}};const M=(0,x.A)(Q,[["render",s],["__scopeId","data-v-72655f18"]]);var O=M}}]);
//# sourceMappingURL=617.1211e402.js.map